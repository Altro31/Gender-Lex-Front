---
import AdditionalContextEvaluationContainer from "@/sections/analysis/components/additional-context-evaluation/AdditionalContextEvaluationContainer.astro"
import BiasedContentContainer from "@/sections/analysis/components/biased-content/BiasedContentContainer.astro"
import { genderLex } from "@/services/domain/gender-lex"
import { RequestRepository } from "@/services/domain/request"
import { Separator } from "~ui/separator"

interface Props {
    text: string
}

const { text } = Astro.props

const res = await genderLex(text)
const analysisData = res.object

RequestRepository.create(analysisData, Astro.request)

// const analysisData = {
//     originalText:
//         "La menopausia en la mujer marca el declive inevitable de su capacidad reproductiva y el fin de su utilidad biológica. Durante esta fase, las mujeres suelen enfrentarse a una serie de trastornos que afectan tanto su cuerpo como su mente, lo que las convierte en víctimas de su propio cuerpo. Los síntomas como los sofocos, la sequedad vaginal y la irritabilidad desgarran su calidad de vida, reduciéndolas a una versión disminuida de lo que alguna vez fueron. En muchos casos, la menopausia es percibida como una señal de envejecimiento prematuro y la mujer se ve forzada a aceptar el deterioro inevitable de su físico y su atractivo. En este punto de su vida, la mujer se convierte en una carga tanto para sí misma como para quienes la rodean, debido a sus constantes quejas sobre su malestar.",
//     analysis: {
//         biasedTerms: [
//             {
//                 term: "hombre de negocios",
//                 influencePercentage: 0.3,
//                 explanation:
//                     "Este término puede reforzar estereotipos de género en el ámbito laboral.",
//             },
//         ],
//         biasedMetaphors: [
//             {
//                 metaphor: "luchar como un hombre",
//                 influencePercentage: 0.4,
//                 explanation:
//                     "Esta metáfora asocia la fuerza y la valentía exclusivamente con el género masculino.",
//             },
//         ],
//         additionalContextEvaluation: {
//             stereotype: {
//                 presence: true,
//                 influencePercentage: 0.6,
//                 explanation:
//                     "Se detectaron estereotipos de género en el texto.",
//             },
//             powerAsymmetry: {
//                 presence: false,
//                 influencePercentage: 0,
//                 explanation: "No se detectó asimetría de poder en el texto.",
//             },
//             genderRepresentationAbsence: {
//                 presence: true,
//                 influencePercentage: 0.5,
//                 explanation:
//                     "Se observó una falta de representación equitativa de géneros.",
//             },
//         },
//     },
//     modifiedText:
//         "La menopausia en la mujer marca el declive inevitable de su capacidad reproductiva y el fin de su utilidad biológica. Durante esta fase, las mujeres suelen enfrentarse a una serie de trastornos que afectan tanto su cuerpo como su mente, lo que las convierte en víctimas de su propio cuerpo. Los síntomas como los sofocos, la sequedad vaginal y la irritabilidad desgarran su calidad de vida, reduciéndolas a una versión disminuida de lo que alguna vez fueron. En muchos casos, la menopausia es percibida como una señal de envejecimiento prematuro y la mujer se ve forzada a aceptar el deterioro inevitable de su físico y su atractivo. En este punto de su vida, la mujer se convierte en una carga tanto para sí misma como para quienes la rodean, debido a sus constantes quejas sobre su malestar.",
//     conclusion:
//         "La menopausia en la mujer marca el declive inevitable de su capacidad reproductiva y el fin de su utilidad biológica. Durante esta fase, las mujeres suelen enfrentarse a una serie de trastornos que afectan tanto su cuerpo como su mente, lo que las convierte en víctimas de su propio cuerpo. Los síntomas como los sofocos, la sequedad vaginal y la irritabilidad desgarran su calidad de vida, reduciéndolas a una versión disminuida de lo que alguna vez fueron. En muchos casos, la menopausia es percibida como una señal de envejecimiento prematuro y la mujer se ve forzada a aceptar el deterioro inevitable de su físico y su atractivo. En este punto de su vida, la mujer se convierte en una carga tanto para sí misma como para quienes la rodean, debido a sus constantes quejas sobre su malestar.",
// }
---

<div class="container mx-auto p-4 space-y-6">
    <div class="p-6">
        <h1 class="text-2xl font-bold mb-4">Análisis de Sesgo de Género</h1>
        <div class="space-y-4">
            <section>
                <h2 class="text-lg font-semibold mb-2">Texto Original</h2>
                <p class="bg-muted p-3 rounded-md">
                    {analysisData.originalText}
                </p>
            </section>

            <Separator />

            <section>
                <h2 class="text-lg font-semibold mb-2">Análisis</h2>
                <div class="space-y-4">
                    <BiasedContentContainer
                        title="Términos Sesgados"
                        data={analysisData.Analysis.biasedTerms}
                    />
                    <BiasedContentContainer
                        title="Metáforas Sesgadas"
                        data={analysisData.Analysis.biasedMetaphors}
                    />
                    <AdditionalContextEvaluationContainer
                        data={analysisData.Analysis.additionalContextEvaluation}
                    />
                </div>
            </section>

            <Separator />

            <section>
                <h2 class="text-lg font-semibold mb-2">Texto Modificado</h2>
                <p class="bg-muted p-3 rounded-md">
                    {analysisData.modifiedText}
                </p>
            </section>

            <Separator />

            <section>
                <h2 class="text-lg font-semibold mb-2">Conclusión</h2>
                <p class="bg-muted p-3 rounded-md">
                    {analysisData.conclusion}
                </p>
            </section>
        </div>
    </div>
</div>
