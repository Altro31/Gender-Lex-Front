---
import { Textarea } from "~ui/textarea"
---

<analyze-text-input class="flex-1">
    <Textarea
        className="px-4 resize-none"
        placeholder="Analizar un texto..."
        id="analyze-text"
        name="text"
    />
</analyze-text-input>

<script>
    import {
        $analyzeFile,
        $analyzeText,
    } from "@/sections/home/stores/analyle-input"

    class AnalyzeTextInput extends HTMLElement {
        connectedCallback() {
            const text: HTMLInputElement | null =
                this.querySelector("#analyze-text")
            text?.addEventListener("input", (e) => {
                const target = e.target as HTMLInputElement | null
                if (!target) return
                $analyzeText.set(target.value)
            })
            $analyzeFile.subscribe((value) => {
                if (text) text.disabled = !!value
            })
            $analyzeText.subscribe((value) => {
                if (text) text.value = value
            })
        }
    }

    customElements.define("analyze-text-input", AnalyzeTextInput)
</script>
